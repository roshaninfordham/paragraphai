# ─── ESSENTIAL: Core Pipeline APIs ───────────────────────────

# NVIDIA NIM (Direct - Nemotron intent parsing with structured output)
# Get key at: https://build.nvidia.com
# Free tier: ~40 req/min, 1000-5000 initial credits
NVIDIA_API_KEY=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

# OpenRouter (Unified LLM gateway for Claude + Nemotron routing)
# Get key at: https://openrouter.ai
# Fallback models, response healing, multi-model routing
OPENROUTER_API_KEY=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

# ─── OPTIONAL: Enhanced Capabilities ──────────────────────────

# Databricks (LLM gateway + Vector Search for design knowledge RAG)
# Get workspace and token at: https://www.databricks.com/learn
# Note: Vector search index must be created separately (catalog.schema.design_templates)
DATABRICKS_HOST=https://dbc-xxxxx.cloud.databricks.com
DATABRICKS_TOKEN=dapi_REDACTED_SEE_ENV_LOCAL

# Nia (Code documentation search - skip for demo, only useful during development)
# Get key at: https://docs.trynia.ai/welcome
# NIA_API_KEY=nk_nefgaTwoo2heij5ZHj27aM8xDYodJdjE

# ─── Application Configuration ────────────────────────────────

# ParaGraph branding
APP_NAME=ParaGraph
APP_URL=https://paragraph.app

# Feature Flags
# Enable/disable optional features (vector search, sketch analysis, etc.)
ENABLE_DESIGN_SEARCH=true
ENABLE_SKETCH_ANALYSIS=true
ENABLE_AGENTIC_REASONING=true

# ─── API Documentation ───────────────────────────────────────

# NEW API ROUTES:
# 
# POST /api/parse-intent
#   Uses NVIDIA NIM Nemotron with guided_json for structured intent parsing
#   Input: { prompt: string }
#   Output: { intent: ParametricIntent, thinking?: string }
#   Confidence: Guaranteed valid JSON due to guided_json constraint
#
# POST /api/edit-node
#   Updated to use OpenRouter + Claude with better parametric prompts
#   Input: { instruction, node, fullTree? }
#   Output: { params: Record<string, number|string> }
#   Optimized: Low temperature for precise parameter edits
#
# POST /api/design-search
#   Queries Databricks Vector Search for relevant design templates
#   Input: { query, category?, numResults? }
#   Output: { results: Template[], source, count }
#   Graceful: Returns empty results if index not configured
#
# POST /api/generate-agentic
#   Enhanced code generation with agentic thinking + design RAG
#   Input: { designTree, prompt, useVectorSearch? }
#   Output: { code, thinking?, templateCount, length }
#   Combines: Vector search templates + Claude reasoning
#
# POST /api/sketch-analysis
#   NVIDIA Nemotron 12B VL for sketch/photo parametric extraction
#   Input: { imageUrl | imageBase64, mimeType?, context? }
#   Output: { analysis: SketchAnalysis, timestamp }
#   Use case: Upload photo of gear → extract teeth count, diameter, etc.

# ─── EXISTING APIs (Unchanged) ──────────────────────────────

# POST /api/generate - SSE stream for full pipeline (nemotron → claude → compile)
# POST /api/compile - OpenSCAD → STL binary compilation
# POST /api/critique - Nemotron code review
# POST /api/iterate - Multi-step refinement loop
